<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>AI训练与部署 | 笔记分享</title><meta name="keywords" content="C/C++"><meta name="author" content="陈桑"><meta name="copyright" content="陈桑"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="AI训练与部署"><meta name="application-name" content="AI训练与部署"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="AI训练与部署"><meta property="og:url" content="http://example.com/2026/01/30/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/AI%E5%BE%AE%E8%B0%83%E4%B8%8E%E9%83%A8%E7%BD%B2/index.html"><meta property="og:site_name" content="笔记分享"><meta property="og:description" content="LlamaFactory安装与使用一.准备工作：给电脑装基础工具 配置python环境 要求版本大于3.11 安装Git  二.下载LlamaFactory使用Git拉取 ​	 1git clone https:&amp;#x2F;&amp;#x2F;github.com&amp;#x2F;hiyouga&amp;#x2F;LLaMA-Factory.git  跳转到对"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/104813758_p1.png"><meta property="article:author" content="陈桑"><meta property="article:tag" content="C/C++"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/104813758_p1.png"><meta name="description" content="LlamaFactory安装与使用一.准备工作：给电脑装基础工具 配置python环境 要求版本大于3.11 安装Git  二.下载LlamaFactory使用Git拉取 ​	 1git clone https:&amp;#x2F;&amp;#x2F;github.com&amp;#x2F;hiyouga&amp;#x2F;LLaMA-Factory.git  跳转到对"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2026/01/30/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/AI%E5%BE%AE%E8%B0%83%E4%B8%8E%E9%83%A8%E7%BD%B2/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '笔记分享',
  title: 'AI训练与部署',
  postAI: '',
  pageFillDescription: 'LlamaFactory安装与使用, 一.准备工作：给电脑装基础工具, 二.下载LlamaFactory, 三、安装运行依赖, 四、启动LlamaFactory界面, 五、界面核心功能速查表, 六、常见问题排查, 使用LlamaFactory训练模型, 一首先下载想要训练的模型和想要用的数据集, 下载数据集, 现在需要导入数据集, 二训练模型阶段, 1.导入模型, 2.数据集, 3.测试模型能不能用, 4.开始训练, 5.导出模型, 解决 CUDA没有找到 这个问题, 1. 如何验证 PyTorch 正在用 CUDA 11.8?, 2. 安装 CUDA 11.8 对应的 PyTorch, 3. 为什么不用管 nvcc -V 输出？, 4. 什么时候要刻意切换全局 CUDA 版本？, 5. 多版本 CUDA Toolkit 共存x2F切换方法（仅当需要 nvcc）, 6. 小结（行动方案）, 判断数据集格式与导入数据集的方法, Alpaca 格式, 在 dataset_info.json 中添加配置, 操作步骤：, 添加后的样子：, 配置说明：, ShareGPT 格式说明, 第一步：准备数据集文件, 第二步：在 dataset_info.json 中添加配置, 使用Ollama进行模型部署, 一个简单案例安装与使用一准备工作给电脑装基础工具配置环境要求版本大于安装二下载使用拉取跳转到对应目录三安装运行依赖一键安装环境四启动界面启动命令按回车等黑框里跳完字最后会显示打开浏览器在地址栏输入按回车就能看到界面啦黑框框要一直开着最小化到任务栏就行别关掉一关界面就没了五界面核心功能速查表区域标签功能说明你现在的设置顶部设置区语言选择模型使用的语言如中文英文已选中文模型名称选择要使用的大模型不同模型效果不同已选模型路径模型文件在你电脑里的位置自动填充不用改模型下载源从哪里下载模型网络不好选已选中间微调设置区微调方法选择训练模型的方式最常用省资源已选量化等级让模型变小节省电脑内存就是不压缩已选量化方法压缩模型的具体算法已选对话模板模型理解对话的格式和模型对应已选下方标签页训练模型的主页面设置训练参数当前所在页面训练后测试模型效果看回答准不准训练完再用直接和模型聊天测试对话能力随时可以点进去聊把训练好的模型导出方便以后用训练满意后导出六常见问题排查启动时出现安装兼容版本的工具输入如果准备训练时报出没有找到则是因为环境中没有或者与对应的版本不匹配使用训练模型一首先下载想要训练的模型和想要用的数据集例如从魔塔社区上下载模型模型库下载数据集下载图中对应的文件即可现在需要导入数据集跳转到的根目录将文件放到目录中修改目录文件导入之前需要查看数据集格式当前数据集格式为格式数据集在该文件最底下添加添加后的样子添加完成后文件的最后几行是这样二训练模型阶段导入模型找到与你下载模型对应的模型名称并设置好刚刚下载好的模型路径模型根目录数据集在数据集处填入刚刚导入的文件的名称测试模型能不能用点击进入如下界面测试前记得先卸载模型避免当前对话用的是之前加载的模型测试没问题即可进入下一步开始训练点击训练即可导出模型训练完成之后点击对应的检查点填写导出目录导出即可解决没有找到这个问题如何验证正在用在你的虚拟环境下进入运行是否可用检测到的版本数量无期望输出是显示名称能正常输出只要这样就会使用属于虚拟环境下的安装对应的如果上述方法找不到则使用该方案使用如下命令推荐用官方通道和是指定官方通道上面命令会自动安装支持的及相关依赖注意这个安装只会下载所需的运行库不会装全局如果你只训练推理模型够用了为什么不用管输出除非你要手写扩展插件二次开发绝大多数训练任务完全不关心版本等训练任务调用的是动态库不是自己用编译也不会用到全局只用到与驱动和匹配的库什么时候要刻意切换全局版本只有当你手动用编译自定义源码即需要调用的编译文件才涉及的具体版本普通训练推理等无须关心如果你强烈需要指定某个版本可以多版本共存并在命令行先再运行参考下文多版本共存切换方法仅当需要官网下载并安装假如装在用时不要卸载高版本只在需要用时做如下操作这时的主版本就变成了仅影响本命令行窗口不影响系统小结行动方案绝大多数情况下只需上述安装不需要切换全局训练推理都能用验证代码见第点就没问题只有你要手动二次开发扩展才考虑版本且无需卸载高版本判断数据集格式与导入数据集的方法格式首先我看到是一个中文对话数据集格式是这样的小姐别的秀女都在求中选唯有咱们小姐想被撂牌子菩萨一定记得真真儿的嘘都说许愿说破是不灵的这个温太医啊也是古怪谁不知太医不得皇命不能为皇族以外的人请脉诊病他倒好十天半月便往咱们府里跑你们俩话太多了我该和温太医要一剂药好好治治你们这是标准的格式包含三个字段用户指令必填用户输入选填这里是空的模型回答必填在中添加配置现在我需要在文件中添加数据集的配置操作步骤打开文件您已经在中打开了这个文件位置在在文件末尾添加配置找到文件的最后一行在前面添加的配置具体来说在第行的前面添加添加后的样子添加完成后文件的最后几行是这样配置说明数据集的名称您在训练时会用到这个名字数据集文件的名称字段映射告诉系统如何对应数据集中的字段把字段作为提示词把字段作为输入这里是空的把字段作为回答格式说明格式的数据集结构与格式不同它是对话式的包含多个角色的交互基本结构用户的问题或指令模型的回答用户的追问模型的回答系统提示词可选工具描述可选关键字段对话历史包含多个消息对象消息发送者常见值有用户助手工具调用工具返回结果消息内容系统提示词可选工具描述可选用于工具调用场景添加步骤第一步准备数据集文件假设您有一个格式的数据集文件内容如下你好能介绍一下自己吗你好我是一个人工智能助手很高兴为你服务什么是机器学习机器学习是人工智能的一个分支它使计算机能够从数据中学习并改进性能第二步在中添加配置操作步骤打开文件位置按自己实际的位置修改在文件末尾添加配置在最后一个前面添加以下内容配置说明数据集名称数据集文件名称必须设置告诉系统这是格式字段映射将字段映射为系统的字段包含系统提示词的情况如果您的数据集包含字段配置应改为使用进行模型部署导出完毕后进入导出目录或到导出目录接下来可以导入到当中首先需要在该模型文件的绝对路径执行终端然后执行中括号中的名称可以改成自己需要的名称之后我们就可以执行查看模型是否创建成功然后我们可以执行模型名称运行模型实测效果一个简单案例导入正则表达式模块消息不能为空核心过滤逻辑开始使用删除及其内部的所有内容确保换行符也能被匹配到核心过滤逻辑结束将干净的回复存入上下文避免历史记录中带有干扰标签错误服务器连接失败聊天室你好我是由驱动的助手有什么我可以帮你的吗输入消息发送显示用户消息错误无法连接到后端服务器',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-01-30 13:57:12',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/4db96df0ca6fdff40335f35fc7058639c1740902_raw.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">笔记分享</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/4db96df0ca6fdff40335f35fc7058639c1740902_raw.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/4db96df0ca6fdff40335f35fc7058639c1740902_raw.jpg"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/4db96df0ca6fdff40335f35fc7058639c1740902_raw.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/4db96df0ca6fdff40335f35fc7058639c1740902_raw.jpg"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2026/01/"><span class="card-archive-list-date">一月 2026</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">40</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/" itemprop="url">实习总结</a></span><span class="article-meta tags"></span></div></div><h1 class="post-title" itemprop="name headline">AI训练与部署</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2026-01-30T05:55:29.420Z" title="发表于 2026-01-30 13:55:29">2026-01-30</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2026-01-30T05:57:12.032Z" title="更新于 2026-01-30 13:57:12">2026-01-30</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为河南"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>河南</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/104813758_p1.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2026/01/30/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/AI%E5%BE%AE%E8%B0%83%E4%B8%8E%E9%83%A8%E7%BD%B2/"><header><a class="post-meta-categories" href="/categories/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/" itemprop="url">实习总结</a><h1 id="CrawlerTitle" itemprop="name headline">AI训练与部署</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">陈桑</span><time itemprop="dateCreated datePublished" datetime="2026-01-30T05:55:29.420Z" title="发表于 2026-01-30 13:55:29">2026-01-30</time><time itemprop="dateCreated datePublished" datetime="2026-01-30T05:57:12.032Z" title="更新于 2026-01-30 13:57:12">2026-01-30</time></header><h1 id="LlamaFactory安装与使用"><a href="#LlamaFactory安装与使用" class="headerlink" title="LlamaFactory安装与使用"></a>LlamaFactory安装与使用</h1><h2 id="一-准备工作：给电脑装基础工具"><a href="#一-准备工作：给电脑装基础工具" class="headerlink" title="一.准备工作：给电脑装基础工具"></a>一.准备工作：给电脑装基础工具</h2><ul>
<li>配置python环境 要求版本大于3.11</li>
<li>安装Git</li>
</ul>
<h2 id="二-下载LlamaFactory"><a href="#二-下载LlamaFactory" class="headerlink" title="二.下载LlamaFactory"></a>二.下载LlamaFactory</h2><p>使用Git拉取</p>
<p>​	</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/hiyouga/LLaMA-Factory.git</span><br></pre></td></tr></table></figure>

<p>跳转到对应目录</p>
<p>​	</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> LLaMA-Factory</span><br></pre></td></tr></table></figure>

<h2 id="三、安装运行依赖"><a href="#三、安装运行依赖" class="headerlink" title="三、安装运行依赖"></a>三、安装运行依赖</h2><p>一键安装环境</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -e .[full]</span><br></pre></td></tr></table></figure>

<h2 id="四、启动LlamaFactory界面"><a href="#四、启动LlamaFactory界面" class="headerlink" title="四、启动LlamaFactory界面"></a>四、启动LlamaFactory界面</h2><p>启动命令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llamafactory-cli webui</span><br></pre></td></tr></table></figure>

<p>按回车，等黑框里跳完字，最后会显示 <code>Running on http://localhost:7860</code>。</p>
<p>打开浏览器，在地址栏输入：<code>http://localhost:7860</code> 按回车，就能看到界面啦！</p>
<p>黑框框要一直开着，最小化到任务栏就行，别关掉，一关界面就没了！！！</p>
<h2 id="五、界面核心功能速查表"><a href="#五、界面核心功能速查表" class="headerlink" title="五、界面核心功能速查表"></a>五、界面核心功能速查表</h2><table>
<thead>
<tr>
<th>区域&#x2F;标签</th>
<th>功能说明</th>
<th>你现在的设置</th>
</tr>
</thead>
<tbody><tr>
<td><strong>顶部设置区</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>语言</td>
<td>选择模型使用的语言（如中文zh、英文en）</td>
<td>已选「zh（中文）」</td>
</tr>
<tr>
<td>模型名称</td>
<td>选择要使用的大模型（不同模型效果不同）</td>
<td>已选「DeepSeek-R1-1.5B-Distill」</td>
</tr>
<tr>
<td>模型路径</td>
<td>模型文件在你电脑里的位置</td>
<td>自动填充，不用改</td>
</tr>
<tr>
<td>模型下载源</td>
<td>从哪里下载模型（网络不好选ModelScope）</td>
<td>已选「huggingface」</td>
</tr>
<tr>
<td><strong>中间微调设置区</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>微调方法</td>
<td>选择训练模型的方式（lora最常用，省资源）</td>
<td>已选「lora」</td>
</tr>
<tr>
<td>量化等级</td>
<td>让模型变小，节省电脑内存（none就是不压缩）</td>
<td>已选「none」</td>
</tr>
<tr>
<td>量化方法</td>
<td>压缩模型的具体算法</td>
<td>已选「bnb」</td>
</tr>
<tr>
<td>对话模板</td>
<td>模型理解对话的格式（和模型对应）</td>
<td>已选「deepseek1」</td>
</tr>
<tr>
<td><strong>下方标签页</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Train</td>
<td>训练模型的主页面，设置训练参数</td>
<td>当前所在页面</td>
</tr>
<tr>
<td>Evaluate &amp; Predict</td>
<td>训练后测试模型效果，看回答准不准</td>
<td>训练完再用</td>
</tr>
<tr>
<td>Chat</td>
<td>直接和模型聊天，测试对话能力</td>
<td>随时可以点进去聊</td>
</tr>
<tr>
<td>Export</td>
<td>把训练好的模型导出，方便以后用</td>
<td>训练满意后导出</td>
</tr>
</tbody></table>
<h2 id="六、常见问题排查"><a href="#六、常见问题排查" class="headerlink" title="六、常见问题排查"></a>六、常见问题排查</h2><p>1.<strong>启动时出现</strong> <strong><code>AttributeError</code></strong>：安装兼容版本的工具，输入 <code>pip install trl==0.9.6 tyro==0.9.8</code></p>
<p>2.如果准备训练时报出‘CUDA没有找到’ 则是因为环境中没有cuda 或者pytorch与对应的cuda版本不匹配</p>
<h1 id="使用LlamaFactory训练模型"><a href="#使用LlamaFactory训练模型" class="headerlink" title="使用LlamaFactory训练模型"></a>使用LlamaFactory训练模型</h1><h2 id="一，首先下载想要训练的模型和想要用的数据集"><a href="#一，首先下载想要训练的模型和想要用的数据集" class="headerlink" title="一，首先下载想要训练的模型和想要用的数据集"></a>一，首先下载想要训练的模型和想要用的数据集</h2><p>例如从魔塔社区上下载模型<a target="_blank" rel="noopener" href="https://www.modelscope.cn/models/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B/summary">DeepSeek-R1-Distill-Qwen-1.5B · 模型库</a></p>
<h3 id="下载数据集"><a href="#下载数据集" class="headerlink" title="下载数据集"></a><strong>下载数据集</strong></h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/%E9%AD%94%E5%A1%94%E7%A4%BE%E5%8C%BA%E4%B8%8B%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86%E7%A4%BA%E4%BE%8B.png" alt="魔塔社区下载数据集示例"></p>
<p>下载图中对应的json文件即可</p>
<h3 id="现在需要导入数据集"><a href="#现在需要导入数据集" class="headerlink" title="现在需要导入数据集"></a><strong>现在需要导入数据集</strong></h3><p>1.跳转到LlamaFactory的根目录</p>
<p>2.将huanhuan.json文件放到data目录中</p>
<p>3.修改data目录dataset_info.json文件</p>
<p>导入之前需要查看数据集格式，当前数据集格式为Alpaca 格式数据集</p>
<p>在该文件最底下添加</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;huanhuan&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;huanhuan.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;instruction&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="string">&quot;input&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;response&quot;</span><span class="punctuation">:</span> <span class="string">&quot;output&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p><strong>添加后的样子：</strong></p>
<p>添加完成后，文件的最后几行是这样：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  <span class="attr">&quot;huanhuan&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;huanhuan.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;instruction&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="string">&quot;input&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;response&quot;</span><span class="punctuation">:</span> <span class="string">&quot;output&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="二，训练模型阶段"><a href="#二，训练模型阶段" class="headerlink" title="二，训练模型阶段"></a>二，训练模型阶段</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/LLaMAFactory%E4%B8%BB%E7%95%8C%E9%9D%A2.png" alt="LLaMAFactory主界面"></p>
<h3 id="1-导入模型"><a href="#1-导入模型" class="headerlink" title="1.导入模型"></a>1.导入模型</h3><p>找到与你下载模型对应的模型名称 ，并设置好刚刚下载好的模型路径（模型根目录）</p>
<h3 id="2-数据集"><a href="#2-数据集" class="headerlink" title="2.数据集"></a>2.数据集</h3><p>在数据集处填入huanhuan（刚刚导入的huanhuan.json文件的名称）</p>
<h3 id="3-测试模型能不能用"><a href="#3-测试模型能不能用" class="headerlink" title="3.测试模型能不能用"></a>3.测试模型能不能用</h3><p>点击chat进入如下界面</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/chat%E7%95%8C%E9%9D%A2.png" alt="chat界面"></p>
<p>测试前记得先卸载模型，避免当前对话用的是之前加载的模型</p>
<p>测试没问题即可进入下一步</p>
<h3 id="4-开始训练"><a href="#4-开始训练" class="headerlink" title="4.开始训练"></a>4.开始训练</h3><p>点击训练即可</p>
<h3 id="5-导出模型"><a href="#5-导出模型" class="headerlink" title="5.导出模型"></a>5.导出模型</h3><p>训练完成之后，点击对应的检查点，填写导出目录导出即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/%E6%A8%A1%E5%9E%8B%E6%A3%80%E6%9F%A5%E7%82%B9.png" alt="模型检查点"></p>
<h2 id="解决-CUDA没有找到-这个问题"><a href="#解决-CUDA没有找到-这个问题" class="headerlink" title="解决 CUDA没有找到 这个问题"></a>解决 CUDA没有找到 这个问题</h2><h3 id="1-如何验证-PyTorch-正在用-CUDA-11-8"><a href="#1-如何验证-PyTorch-正在用-CUDA-11-8" class="headerlink" title="1. 如何验证 PyTorch 正在用 CUDA 11.8?"></a>1. <strong>如何验证 PyTorch 正在用 CUDA 11.8?</strong></h3><p>在你的 conda 虚拟环境 <code>LLaMAF</code> 下，进入 Python，运行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;CUDA是否可用？&quot;</span>, torch.cuda.is_available())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;PyTorch检测到的CUDA版本：&quot;</span>, torch.version.cuda)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;GPU数量：&quot;</span>, torch.cuda.device_count())</span><br><span class="line"><span class="built_in">print</span>(torch.cuda.get_device_name(<span class="number">0</span>) <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;无GPU&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>期望输出：</p>
<ul>
<li><code>torch.cuda.is_available()</code> 是 <code>True</code></li>
<li><code>torch.version.cuda</code> 显示 <code>11.8</code></li>
<li>GPU 名称能正常输出</li>
</ul>
<p><strong>只要这样，PyTorch 就会使用属于 conda 虚拟环境下的 11.8 CUDA runtime。</strong></p>
<h3 id="2-安装-CUDA-11-8-对应的-PyTorch"><a href="#2-安装-CUDA-11-8-对应的-PyTorch" class="headerlink" title="2. 安装 CUDA 11.8 对应的 PyTorch"></a>2. 安装 CUDA 11.8 对应的 PyTorch</h3><blockquote>
<p>如果上述方法找不到则使用该方案</p>
</blockquote>
<p>使用如下 conda 命令（<strong>推荐用官方通道</strong>）：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install pytorch torchvision torchaudio pytorch-cuda=11.8 -c pytorch -c nvidia</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-c pytorch</code> 和 <code>-c nvidia</code> 是指定官方通道</li>
<li>上面命令会自动安装支持 CUDA 11.8 的 pytorch 及相关依赖</li>
</ul>
<p><strong>注意：</strong> 这个安装只会下载 PyTorch 所需的 CUDA 运行库，不会装全局 CUDA Toolkit。如果你只训练&#x2F;推理模型够用了！</p>
<h3 id="3-为什么不用管-nvcc-V-输出？"><a href="#3-为什么不用管-nvcc-V-输出？" class="headerlink" title="3. 为什么不用管 nvcc -V 输出？"></a>3. <strong>为什么不用管 nvcc -V 输出？</strong></h3><blockquote>
<p>除非你要手写 CUDA 扩展&#x2F;插件（二次开发），绝大多数 LLaMA、transformers 训练任务 <strong>完全不关心 nvcc 版本</strong>。</p>
<p>PyTorch 等训练任务调用的是 DLL（so）动态库，不是自己用 nvcc 编译，也不会用到全局 CUDA toolkit，只用到与驱动和 pytorch-cuda 匹配的库。</p>
</blockquote>
<hr>
<h3 id="4-什么时候要刻意“切换”全局-CUDA-版本？"><a href="#4-什么时候要刻意“切换”全局-CUDA-版本？" class="headerlink" title="4. 什么时候要刻意“切换”全局 CUDA 版本？"></a>4. <strong>什么时候要刻意“切换”全局 CUDA 版本？</strong></h3><ul>
<li>只有当你<strong>手动用 nvcc 编译自定义 CUDA 源码</strong>（即：需要 cmake&#x2F;make 调用 CUDA toolkit 的 bin&#x2F;nvcc 编译 .cu 文件），才涉及 CUDA toolkit (nvcc) 的具体版本。</li>
<li>普通 LLaMA Factory 训练&#x2F;推理、Pytorch&#x2F;TensorFlow 等无须关心。</li>
<li>如果你强烈需要指定某个 nvcc 版本，可以多版本 CUDA toolkit 共存，并在命令行先 <code>set PATH</code> 再运行 nvcc，参考下文。</li>
</ul>
<hr>
<h3 id="5-多版本-CUDA-Toolkit-共存-切换方法（仅当需要-nvcc）"><a href="#5-多版本-CUDA-Toolkit-共存-切换方法（仅当需要-nvcc）" class="headerlink" title="5. 多版本 CUDA Toolkit 共存&#x2F;切换方法（仅当需要 nvcc）"></a>5. <strong>多版本 CUDA Toolkit 共存&#x2F;切换方法（仅当需要 nvcc）</strong></h3><ol>
<li><p><strong>官网下载并安装 CUDA 11.8 toolkit</strong>（<a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-toolkit-archive">NVIDIA CUDA Toolkit Archive</a>）。</p>
</li>
<li><p>假如装在：<code>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.8</code></p>
</li>
<li><p>用时不要卸载高版本，只在需要用 11.8 nvcc 时做如下操作：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> &quot;<span class="built_in">PATH</span>=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.<span class="number">8</span>\bin;<span class="variable">%PATH%</span>&quot;</span><br><span class="line"><span class="built_in">set</span> &quot;CUDA_PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.<span class="number">8</span>&quot;</span><br><span class="line">nvcc -V</span><br></pre></td></tr></table></figure>

<p>这时 nvcc -V 的主版本就变成 11.8 了，仅影响本命令行窗口，不影响系统。</p>
</li>
</ol>
<hr>
<h3 id="6-小结（行动方案）"><a href="#6-小结（行动方案）" class="headerlink" title="6. 小结（行动方案）"></a>6. <strong>小结（行动方案）</strong></h3><ul>
<li><strong>绝大多数情况下只需上述 conda 安装 cuda 11.8(pytorch-cuda&#x3D;11.8)！不需要切换全局 nvcc。训练推理都能用 GPU。</strong></li>
<li>验证代码见第2点，is_available&#x3D;&#x3D;True, torch.version.cuda&#x3D;&#x3D;’11.8’ 就没问题。</li>
<li>只有你要手动二次开发 CUDA C++ 扩展才考虑 nvcc 版本，且无需卸载高版本！</li>
</ul>
<h2 id="判断数据集格式与导入数据集的方法"><a href="#判断数据集格式与导入数据集的方法" class="headerlink" title="判断数据集格式与导入数据集的方法"></a>判断数据集格式与导入数据集的方法</h2><h3 id="Alpaca-格式"><a href="#Alpaca-格式" class="headerlink" title="Alpaca 格式"></a>Alpaca 格式</h3><p>首先，我看到 <code>huanhuan.json</code> 是一个<strong>中文对话数据集</strong>，格式是这样的：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;小姐，别的秀女都在求中选，唯有咱们小姐想被撂牌子，菩萨一定记得真真儿的——&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;嘘——都说许愿说破是不灵的。&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;这个温太医啊，也是古怪，谁不知太医不得皇命不能为皇族以外的人请脉诊病，他倒好，十天半月便往咱们府里跑。&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你们俩话太多了，我该和温太医要一剂药，好好治治你们。&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p>这是标准的 <strong>Alpaca 格式</strong>，包含三个字段：</p>
<ul>
<li><code>instruction</code>：用户指令（必填）</li>
<li><code>input</code>：用户输入（选填，这里是空的）</li>
<li><code>output</code>：模型回答（必填）</li>
</ul>
<h4 id="在-dataset-info-json-中添加配置"><a href="#在-dataset-info-json-中添加配置" class="headerlink" title="在 dataset_info.json 中添加配置"></a>在 dataset_info.json 中添加配置</h4><p>现在我需要在 <code>dataset_info.json</code> 文件中添加 <code>huanhuan</code> 数据集的配置。</p>
<h5 id="操作步骤："><a href="#操作步骤：" class="headerlink" title="操作步骤："></a>操作步骤：</h5><ol>
<li><p><strong>打开 dataset_info.json 文件</strong></p>
<ul>
<li>您已经在 IDE 中打开了这个文件，位置在：<code>c:\Users\Administrator\LLaMA-Factory\data\dataset_info.json</code></li>
</ul>
</li>
<li><p><strong>在文件末尾添加配置</strong></p>
<ul>
<li>找到文件的最后一行，在 <code>&#125;</code> 前面添加 huanhuan 的配置</li>
<li>具体来说，在第 720 行的 <code>&#125;</code> 前面添加：</li>
</ul>
</li>
</ol>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;huanhuan&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;huanhuan.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;instruction&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="string">&quot;input&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;response&quot;</span><span class="punctuation">:</span> <span class="string">&quot;output&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<h5 id="添加后的样子："><a href="#添加后的样子：" class="headerlink" title="添加后的样子："></a>添加后的样子：</h5><p>添加完成后，文件的最后几行是这样：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  <span class="attr">&quot;huanhuan&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;huanhuan.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;instruction&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="string">&quot;input&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;response&quot;</span><span class="punctuation">:</span> <span class="string">&quot;output&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h5 id="配置说明："><a href="#配置说明：" class="headerlink" title="配置说明："></a>配置说明：</h5><ul>
<li><code>&quot;huanhuan&quot;</code>：数据集的名称，您在训练时会用到这个名字</li>
<li><code>&quot;file_name&quot;: &quot;huanhuan.json&quot;</code>：数据集文件的名称</li>
<li><code>&quot;columns&quot;</code>：字段映射，告诉系统如何对应数据集中的字段：<ul>
<li><code>&quot;prompt&quot;: &quot;instruction&quot;</code>：把 <code>instruction</code> 字段作为提示词</li>
<li><code>&quot;query&quot;: &quot;input&quot;</code>：把 <code>input</code> 字段作为输入（这里是空的）</li>
<li><code>&quot;response&quot;: &quot;output&quot;</code>：把 <code>output</code> 字段作为回答</li>
</ul>
</li>
</ul>
<h3 id="ShareGPT-格式说明"><a href="#ShareGPT-格式说明" class="headerlink" title="ShareGPT 格式说明"></a>ShareGPT 格式说明</h3><p>ShareGPT 格式的数据集结构与 Alpaca 格式不同，它是<strong>对话式</strong>的，包含多个角色的交互。</p>
<p><strong>基本结构：</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;conversations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;用户的问题或指令&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span> </span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;模型的回答&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;用户的追问&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;模型的回答&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;system&quot;</span><span class="punctuation">:</span> <span class="string">&quot;系统提示词（可选）&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="string">&quot;工具描述（可选）&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p><strong>关键字段：</strong></p>
<ul>
<li><code>conversations</code>：对话历史，包含多个消息对象</li>
<li><code>from</code>：消息发送者，常见值有：<ul>
<li><code>human</code> - 用户</li>
<li><code>gpt</code> - 助手</li>
<li><code>function_call</code> - 工具调用</li>
<li><code>observation</code> - 工具返回结果</li>
</ul>
</li>
<li><code>value</code>：消息内容</li>
<li><code>system</code>：系统提示词（可选）</li>
<li><code>tools</code>：工具描述（可选，用于工具调用场景）</li>
</ul>
<p><strong>添加步骤</strong></p>
<h4 id="第一步：准备数据集文件"><a href="#第一步：准备数据集文件" class="headerlink" title="第一步：准备数据集文件"></a>第一步：准备数据集文件</h4><p>假设您有一个 ShareGPT 格式的数据集文件 <code>my_dialogue.json</code>，内容如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;conversations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你好，能介绍一下自己吗？&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你好！我是一个人工智能助手，很高兴为你服务。&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;conversations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;human&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;什么是机器学习？&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;机器学习是人工智能的一个分支，它使计算机能够从数据中学习并改进性能。&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="第二步：在-dataset-info-json-中添加配置"><a href="#第二步：在-dataset-info-json-中添加配置" class="headerlink" title="第二步：在 dataset_info.json 中添加配置"></a>第二步：在 dataset_info.json 中添加配置</h4><p><strong>操作步骤：</strong></p>
<ol>
<li><p><strong>打开 dataset_info.json 文件</strong></p>
<ul>
<li>位置：<code>c:\Users\Administrator\LLaMA-Factory\data\dataset_info.json</code>（按自己实际的位置修改）</li>
</ul>
</li>
<li><p><strong>在文件末尾添加配置</strong></p>
<ul>
<li>在最后一个 <code>&#125;</code> 前面添加以下内容：</li>
</ul>
</li>
</ol>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;my_dialogue&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my_dialogue.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p><strong>配置说明：</strong></p>
<ul>
<li><code>&quot;my_dialogue&quot;</code>：数据集名称</li>
<li><code>&quot;file_name&quot;: &quot;my_dialogue.json&quot;</code>：数据集文件名称</li>
<li><code>&quot;formatting&quot;: &quot;sharegpt&quot;</code>：<strong>必须设置</strong>，告诉系统这是 ShareGPT 格式</li>
<li><code>&quot;columns&quot;: &#123;&quot;messages&quot;: &quot;conversations&quot;&#125;</code>：字段映射，将 <code>conversations</code> 字段映射为系统的 <code>messages</code> 字段</li>
</ul>
<p><strong>包含系统提示词的情况：</strong></p>
<p>如果您的数据集包含 <code>system</code> 字段，配置应改为：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;my_dialogue&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;file_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my_dialogue.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;formatting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sharegpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;messages&quot;</span><span class="punctuation">:</span> <span class="string">&quot;conversations&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;system&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<h1 id="使用Ollama进行模型部署"><a href="#使用Ollama进行模型部署" class="headerlink" title="使用Ollama进行模型部署"></a>使用Ollama进行模型部署</h1><p>1.导出完毕后进入导出目录，或cd到导出目录，接下来可以导入到ollama当中。</p>
<p>2.首先需要在该模型文件的绝对路径执行cmd终端，然后执行：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ollama create &#123;huanhuan_deepseekr1_1_5b&#125; -f Modelfile</span><br><span class="line"><span class="comment"># （中括号中的名称可以改成自己需要的名称）</span></span><br></pre></td></tr></table></figure>

<p>3.之后我们就可以执行ollama list 查看模型是否创建成功</p>
<p>4.然后我们可以执行ollama run {模型名称} 运行模型实测效果</p>
<h1 id="一个简单案例"><a href="#一个简单案例" class="headerlink" title="一个简单案例"></a>一个简单案例</h1><p>app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, jsonify</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re  <span class="comment"># 导入正则表达式模块</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">OLLAMA_API_URL = <span class="string">&quot;http://localhost:11434/api/chat&quot;</span></span><br><span class="line">messages = []</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/chat&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chat</span>():</span><br><span class="line">    <span class="keyword">global</span> messages</span><br><span class="line">    user_input = request.json.get(<span class="string">&#x27;message&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> user_input:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;消息不能为空&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: user_input&#125;)</span><br><span class="line"></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;model&quot;</span>: <span class="string">&quot;huanhuan_deepseekr1_1_5b:latest&quot;</span>,</span><br><span class="line">        <span class="string">&quot;messages&quot;</span>: messages,</span><br><span class="line">        <span class="string">&quot;stream&quot;</span>: <span class="literal">False</span> </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(OLLAMA_API_URL, json=payload)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            result = response.json()</span><br><span class="line">            raw_content = result.get(<span class="string">&quot;message&quot;</span>, &#123;&#125;).get(<span class="string">&quot;content&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># --- 核心过滤逻辑开始 ---</span></span><br><span class="line">            <span class="comment"># 使用 re.sub 删除 &lt;think&gt;...&lt;/think&gt; 及其内部的所有内容</span></span><br><span class="line">            <span class="comment"># flags=re.DOTALL 确保换行符也能被匹配到</span></span><br><span class="line">            clean_content = re.sub(<span class="string">r&#x27;&lt;think&gt;.*?&lt;/think&gt;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, raw_content, flags=re.DOTALL).strip()</span><br><span class="line">            <span class="comment"># --- 核心过滤逻辑结束 ---</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 将干净的回复存入上下文，避免历史记录中带有干扰标签</span></span><br><span class="line">            messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: clean_content&#125;)</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;reply&quot;</span>: clean_content&#125;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">f&quot;Ollama 错误: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>&#125;), <span class="number">500</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">f&quot;服务器连接失败: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>&#125;), <span class="number">500</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<p>templates&#x2F;index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Ollama AI 聊天室<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123; <span class="attribute">font-family</span>: <span class="string">&#x27;Segoe UI&#x27;</span>, Tahoma, Geneva, Verdana, sans-serif; <span class="attribute">background</span>: <span class="number">#f4f7f6</span>; <span class="attribute">display</span>: flex; <span class="attribute">justify-content</span>: center; <span class="attribute">padding</span>: <span class="number">20px</span>; &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#chat-container</span> &#123; <span class="attribute">width</span>: <span class="number">100%</span>; <span class="attribute">max-width</span>: <span class="number">600px</span>; <span class="attribute">background</span>: white; <span class="attribute">border-radius</span>: <span class="number">10px</span>; <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">15px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.1</span>); <span class="attribute">display</span>: flex; <span class="attribute">flex-direction</span>: column; <span class="attribute">height</span>: <span class="number">80vh</span>; &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#chat-box</span> &#123; <span class="attribute">flex</span>: <span class="number">1</span>; <span class="attribute">overflow-y</span>: auto; <span class="attribute">padding</span>: <span class="number">20px</span>; <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#eee</span>; &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.message</span> &#123; <span class="attribute">margin-bottom</span>: <span class="number">15px</span>; <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">15px</span>; <span class="attribute">border-radius</span>: <span class="number">15px</span>; <span class="attribute">max-width</span>: <span class="number">80%</span>; <span class="attribute">line-height</span>: <span class="number">1.5</span>; &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.user</span> &#123; <span class="attribute">background</span>: <span class="number">#007bff</span>; <span class="attribute">color</span>: white; <span class="attribute">align-self</span>: flex-end; <span class="attribute">margin-left</span>: auto; &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.ai</span> &#123; <span class="attribute">background</span>: <span class="number">#e9ecef</span>; <span class="attribute">color</span>: <span class="number">#333</span>; <span class="attribute">align-self</span>: flex-start; &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#input-area</span> &#123; <span class="attribute">padding</span>: <span class="number">20px</span>; <span class="attribute">display</span>: flex; <span class="attribute">gap</span>: <span class="number">10px</span>; &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">input</span> &#123; <span class="attribute">flex</span>: <span class="number">1</span>; <span class="attribute">padding</span>: <span class="number">12px</span>; <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>; <span class="attribute">border-radius</span>: <span class="number">5px</span>; <span class="attribute">outline</span>: none; &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">button</span> &#123; <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">20px</span>; <span class="attribute">background</span>: <span class="number">#28a745</span>; <span class="attribute">color</span>: white; <span class="attribute">border</span>: none; <span class="attribute">border-radius</span>: <span class="number">5px</span>; <span class="attribute">cursor</span>: pointer; &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">button</span><span class="selector-pseudo">:disabled</span> &#123; <span class="attribute">background</span>: <span class="number">#ccc</span>; &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;chat-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center; color: #444;&quot;</span>&gt;</span>Ollama WebUI<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;chat-box&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message ai&quot;</span>&gt;</span>你好！我是由 Ollama 驱动的助手，有什么我可以帮你的吗？<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;input-area&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;user-input&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;输入消息...&quot;</span> <span class="attr">onkeypress</span>=<span class="string">&quot;if(event.keyCode==13) sendMessage()&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;send-btn&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;sendMessage()&quot;</span>&gt;</span>发送<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">sendMessage</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> inputField = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;user-input&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> chatBox = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;chat-box&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> sendBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;send-btn&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> message = inputField.<span class="property">value</span>.<span class="title function_">trim</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!message) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 显示用户消息</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">appendMessage</span>(<span class="string">&#x27;user&#x27;</span>, message);</span></span><br><span class="line"><span class="language-javascript">        inputField.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        inputField.<span class="property">disabled</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        sendBtn.<span class="property">disabled</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/chat&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">message</span>: message &#125;)</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (data.<span class="property">reply</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">appendMessage</span>(<span class="string">&#x27;ai&#x27;</span>, data.<span class="property">reply</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">appendMessage</span>(<span class="string">&#x27;ai&#x27;</span>, <span class="string">&#x27;错误: &#x27;</span> + data.<span class="property">error</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">catch</span> (e) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">appendMessage</span>(<span class="string">&#x27;ai&#x27;</span>, <span class="string">&#x27;无法连接到后端服务器。&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            inputField.<span class="property">disabled</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            sendBtn.<span class="property">disabled</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            inputField.<span class="title function_">focus</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">appendMessage</span>(<span class="params">role, text</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> chatBox = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;chat-box&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        div.<span class="property">className</span> = <span class="string">`message <span class="subst">$&#123;role&#125;</span>`</span>;</span></span><br><span class="line"><span class="language-javascript">        div.<span class="property">innerText</span> = text;</span></span><br><span class="line"><span class="language-javascript">        chatBox.<span class="title function_">appendChild</span>(div);</span></span><br><span class="line"><span class="language-javascript">        chatBox.<span class="property">scrollTop</span> = chatBox.<span class="property">scrollHeight</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/AI%E5%AF%B9%E8%AF%9D%E6%A1%88%E4%BE%8B%E7%95%8C%E9%9D%A2.png" alt="AI对话案例界面"></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/4db96df0ca6fdff40335f35fc7058639c1740902_raw.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/4db96df0ca6fdff40335f35fc7058639c1740902_raw.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">陈桑</div><div class="post-copyright__author_desc">路漫漫其修远兮</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2026/01/30/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/AI%E5%BE%AE%E8%B0%83%E4%B8%8E%E9%83%A8%E7%BD%B2/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2026/01/30/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/AI%E5%BE%AE%E8%B0%83%E4%B8%8E%E9%83%A8%E7%BD%B2/')">AI训练与部署</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2026/01/30/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/AI%E5%BE%AE%E8%B0%83%E4%B8%8E%E9%83%A8%E7%BD%B2/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=AI训练与部署&amp;url=http://example.com/2026/01/30/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/AI%E5%BE%AE%E8%B0%83%E4%B8%8E%E9%83%A8%E7%BD%B2/&amp;pic=https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/104813758_p1.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">笔记分享</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"></div></div></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/104813758_p1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2025/05/27/%E5%A4%A7%E5%AD%A6%E8%80%83%E8%AF%95/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/0e2228991685cac92e3de7cad6a32e4b472853e4_raw.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">操作系统期末总结</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/4db96df0ca6fdff40335f35fc7058639c1740902_raw.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">C语言从入门到入土</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#LlamaFactory%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">LlamaFactory安装与使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%EF%BC%9A%E7%BB%99%E7%94%B5%E8%84%91%E8%A3%85%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7"><span class="toc-number">1.1.</span> <span class="toc-text">一.准备工作：给电脑装基础工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E4%B8%8B%E8%BD%BDLlamaFactory"><span class="toc-number">1.2.</span> <span class="toc-text">二.下载LlamaFactory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%89%E8%A3%85%E8%BF%90%E8%A1%8C%E4%BE%9D%E8%B5%96"><span class="toc-number">1.3.</span> <span class="toc-text">三、安装运行依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%90%AF%E5%8A%A8LlamaFactory%E7%95%8C%E9%9D%A2"><span class="toc-number">1.4.</span> <span class="toc-text">四、启动LlamaFactory界面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E7%95%8C%E9%9D%A2%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E9%80%9F%E6%9F%A5%E8%A1%A8"><span class="toc-number">1.5.</span> <span class="toc-text">五、界面核心功能速查表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5"><span class="toc-number">1.6.</span> <span class="toc-text">六、常见问题排查</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8LlamaFactory%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.</span> <span class="toc-text">使用LlamaFactory训练模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%EF%BC%8C%E9%A6%96%E5%85%88%E4%B8%8B%E8%BD%BD%E6%83%B3%E8%A6%81%E8%AE%AD%E7%BB%83%E7%9A%84%E6%A8%A1%E5%9E%8B%E5%92%8C%E6%83%B3%E8%A6%81%E7%94%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">2.1.</span> <span class="toc-text">一，首先下载想要训练的模型和想要用的数据集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">2.1.1.</span> <span class="toc-text">下载数据集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%B0%E5%9C%A8%E9%9C%80%E8%A6%81%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">2.1.2.</span> <span class="toc-text">现在需要导入数据集</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%E9%98%B6%E6%AE%B5"><span class="toc-number">2.2.</span> <span class="toc-text">二，训练模型阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.导入模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.数据集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B5%8B%E8%AF%95%E6%A8%A1%E5%9E%8B%E8%83%BD%E4%B8%8D%E8%83%BD%E7%94%A8"><span class="toc-number">2.2.3.</span> <span class="toc-text">3.测试模型能不能用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%BC%80%E5%A7%8B%E8%AE%AD%E7%BB%83"><span class="toc-number">2.2.4.</span> <span class="toc-text">4.开始训练</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%AF%BC%E5%87%BA%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.2.5.</span> <span class="toc-text">5.导出模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3-CUDA%E6%B2%A1%E6%9C%89%E6%89%BE%E5%88%B0-%E8%BF%99%E4%B8%AA%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.</span> <span class="toc-text">解决 CUDA没有找到 这个问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A6%82%E4%BD%95%E9%AA%8C%E8%AF%81-PyTorch-%E6%AD%A3%E5%9C%A8%E7%94%A8-CUDA-11-8"><span class="toc-number">2.3.1.</span> <span class="toc-text">1. 如何验证 PyTorch 正在用 CUDA 11.8?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85-CUDA-11-8-%E5%AF%B9%E5%BA%94%E7%9A%84-PyTorch"><span class="toc-number">2.3.2.</span> <span class="toc-text">2. 安装 CUDA 11.8 对应的 PyTorch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E7%94%A8%E7%AE%A1-nvcc-V-%E8%BE%93%E5%87%BA%EF%BC%9F"><span class="toc-number">2.3.3.</span> <span class="toc-text">3. 为什么不用管 nvcc -V 输出？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E8%A6%81%E5%88%BB%E6%84%8F%E2%80%9C%E5%88%87%E6%8D%A2%E2%80%9D%E5%85%A8%E5%B1%80-CUDA-%E7%89%88%E6%9C%AC%EF%BC%9F"><span class="toc-number">2.3.4.</span> <span class="toc-text">4. 什么时候要刻意“切换”全局 CUDA 版本？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%A4%9A%E7%89%88%E6%9C%AC-CUDA-Toolkit-%E5%85%B1%E5%AD%98-%E5%88%87%E6%8D%A2%E6%96%B9%E6%B3%95%EF%BC%88%E4%BB%85%E5%BD%93%E9%9C%80%E8%A6%81-nvcc%EF%BC%89"><span class="toc-number">2.3.5.</span> <span class="toc-text">5. 多版本 CUDA Toolkit 共存&#x2F;切换方法（仅当需要 nvcc）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%B0%8F%E7%BB%93%EF%BC%88%E8%A1%8C%E5%8A%A8%E6%96%B9%E6%A1%88%EF%BC%89"><span class="toc-number">2.3.6.</span> <span class="toc-text">6. 小结（行动方案）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E9%9B%86%E6%A0%BC%E5%BC%8F%E4%B8%8E%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">2.4.</span> <span class="toc-text">判断数据集格式与导入数据集的方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Alpaca-%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.4.1.</span> <span class="toc-text">Alpaca 格式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8-dataset-info-json-%E4%B8%AD%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE"><span class="toc-number">2.4.1.1.</span> <span class="toc-text">在 dataset_info.json 中添加配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">2.4.1.1.1.</span> <span class="toc-text">操作步骤：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%90%8E%E7%9A%84%E6%A0%B7%E5%AD%90%EF%BC%9A"><span class="toc-number">2.4.1.1.2.</span> <span class="toc-text">添加后的样子：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E%EF%BC%9A"><span class="toc-number">2.4.1.1.3.</span> <span class="toc-text">配置说明：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ShareGPT-%E6%A0%BC%E5%BC%8F%E8%AF%B4%E6%98%8E"><span class="toc-number">2.4.2.</span> <span class="toc-text">ShareGPT 格式说明</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE%E9%9B%86%E6%96%87%E4%BB%B6"><span class="toc-number">2.4.2.1.</span> <span class="toc-text">第一步：准备数据集文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E5%9C%A8-dataset-info-json-%E4%B8%AD%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE"><span class="toc-number">2.4.2.2.</span> <span class="toc-text">第二步：在 dataset_info.json 中添加配置</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Ollama%E8%BF%9B%E8%A1%8C%E6%A8%A1%E5%9E%8B%E9%83%A8%E7%BD%B2"><span class="toc-number">3.</span> <span class="toc-text">使用Ollama进行模型部署</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E6%A1%88%E4%BE%8B"><span class="toc-number">4.</span> <span class="toc-text">一个简单案例</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/30/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/AI%E5%BE%AE%E8%B0%83%E4%B8%8E%E9%83%A8%E7%BD%B2/" title="AI训练与部署"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/104813758_p1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AI训练与部署"/></a><div class="content"><a class="title" href="/2026/01/30/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/AI%E5%BE%AE%E8%B0%83%E4%B8%8E%E9%83%A8%E7%BD%B2/" title="AI训练与部署">AI训练与部署</a><time datetime="2026-01-30T05:55:29.420Z" title="发表于 2026-01-30 13:55:29">2026-01-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/27/%E5%A4%A7%E5%AD%A6%E8%80%83%E8%AF%95/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/" title="操作系统期末总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/0e2228991685cac92e3de7cad6a32e4b472853e4_raw.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统期末总结"/></a><div class="content"><a class="title" href="/2025/05/27/%E5%A4%A7%E5%AD%A6%E8%80%83%E8%AF%95/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/" title="操作系统期末总结">操作系统期末总结</a><time datetime="2025-05-27T13:44:36.767Z" title="发表于 2025-05-27 21:44:36">2025-05-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/27/%E5%A4%A7%E5%AD%A6%E8%80%83%E8%AF%95/%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%9C%9F%E6%9C%AB%E6%80%BB%E7%BB%93/" title="数据采集期末总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/ff2a31dc97be32b3295f7c1a2efe113baa8c650d_raw~1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据采集期末总结"/></a><div class="content"><a class="title" href="/2025/05/27/%E5%A4%A7%E5%AD%A6%E8%80%83%E8%AF%95/%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%9C%9F%E6%9C%AB%E6%80%BB%E7%BB%93/" title="数据采集期末总结">数据采集期末总结</a><time datetime="2025-05-27T12:24:29.582Z" title="发表于 2025-05-27 20:24:29">2025-05-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/26/%E7%AE%97%E6%B3%95/%E9%AB%98%E7%B2%BE%E5%BA%A6/" title="高精度"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/1299677.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="高精度"/></a><div class="content"><a class="title" href="/2025/05/26/%E7%AE%97%E6%B3%95/%E9%AB%98%E7%B2%BE%E5%BA%A6/" title="高精度">高精度</a><time datetime="2025-05-26T09:58:22.158Z" title="发表于 2025-05-26 17:58:22">2025-05-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/26/%E7%AE%97%E6%B3%95/%E9%93%BE%E8%A1%A8/" title="链表"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/Q99966/imgHosting@main/img/1299677.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="链表"/></a><div class="content"><a class="title" href="/2025/05/26/%E7%AE%97%E6%B3%95/%E9%93%BE%E8%A1%A8/" title="链表">链表</a><time datetime="2025-05-26T09:58:22.157Z" title="发表于 2025-05-26 17:58:22">2025-05-26</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">41</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">6</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><span class="sidebar-menu-item-title">标签</span></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("05/18/2025 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2025 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 陈桑 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>